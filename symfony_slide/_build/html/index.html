<!DOCTYPE html>


<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Symfony</title>

    

    
<link rel="stylesheet" href="_static/css/reveal.css">
<link rel="stylesheet" href="_static/css/solarized.css" id="pygment">
<link rel="stylesheet" href="_static/css/theme/openwide.css" id="theme">
<link rel="stylesheet" href="_static/lib/css/zenburn.css">
<link rel="stylesheet" href="_static/revealjs.css" type="text/css" />

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
        if(window.location.search.match(/print-pdf/gi)) {
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = '_static/css/print/pdf.css';
            document.getElementsByTagName('head')[0].appendChild(link);
        }
    </script>

    <!--[if lt IE 9]>
    <script src="_static/lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        
  <section class="first-slide">
<h1>PHP/Symfony</h1>
<h2>EPSI/B2</h2>
</section>
<section>
<section class="first last">
<h1>Supports de cours</h1>
<a class="reference external" href="http://mveyrenc.github.io">http://mveyrenc.github.io</a></section>
</section>
<section>
<section class="first last">
<h1>Symfony</h1>
<p class="first">Framework
+ PHP
+ Open source</p>
<aside class="last notes">
open source = l’utilisation, l’étude, la modification et la duplication en vue de sa diffusion sont permises, techniquement et légalement.</aside>
</section>
</section>
<section>
<section class="first">
<h1>Rappels PHP</h1>
</section>
<section>
<h2>Terminologie</h2>
<dl class="first last docutils">
<dt>Classe</dt>
<dd><ul class="first last simple">
<li>représentation abstraite d’un objet</li>
<li>somme des propriétés (attributs) de l’objet et des traitements (méthodes) dont il est capable</li>
</ul>
</dd>
<dt>Objet</dt>
<dd><ul class="first last simple">
<li>instance de classe</li>
</ul>
</dd>
</dl>
</section>
<section>
<h2>Mots réservés</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>class</strong></td>
<td>déclaration de classe</td>
</tr>
<tr class="row-even"><td><strong>const</strong></td>
<td>déclaration de constante de classe</td>
</tr>
<tr class="row-odd"><td><strong>function</strong></td>
<td>déclaration d&#8217;une méthode</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line"><strong>public</strong></div>
<div class="line"><strong>protected</strong></div>
<div class="line">private</div>
</div>
</td>
<td>visibilité de l&#8217;attribut ou de la méthode (par défaut &#8220;public&#8221; si aucun accès n&#8217;est explicitement défini)</td>
</tr>
<tr class="row-odd"><td><strong>new</strong></td>
<td>création d&#8217;objet</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Mots réservés</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>self</td>
<td>résolution de portée (la classe elle-même)</td>
</tr>
<tr class="row-even"><td><strong>parent</strong></td>
<td>résolution de portée (la classe &#8220;parent&#8221;)</td>
</tr>
<tr class="row-odd"><td>static</td>
<td>résolution de portée (appel statique)</td>
</tr>
<tr class="row-even"><td><strong>extends</strong></td>
<td>héritage de classe</td>
</tr>
<tr class="row-odd"><td>implements</td>
<td>implémentation d&#8217;une interface</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Méthodes magiques</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>__construct()</strong></td>
<td>constructeur de la classe, est appelé lors de le création d&#8217;un objet</td>
</tr>
<tr class="row-even"><td>__destruct()</td>
<td>destructeur de la classe, est appelé lors de la destruction d&#8217;un objet</td>
</tr>
<tr class="row-odd"><td><strong>__set()</strong></td>
<td>déclenchée lors de l&#8217;accès en écriture à une propriété de l&#8217;objet</td>
</tr>
<tr class="row-even"><td><strong>__get()</strong></td>
<td>déclenchée lors de l&#8217;accès en lecture à une propriété de l&#8217;objet</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Méthodes magiques</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>__call()</strong></td>
<td>déclenchée lors de l&#8217;appel d&#8217;une méthode inexistante de la classe</td>
</tr>
<tr class="row-even"><td>__callstatic()</td>
<td>déclenchée lors de l&#8217;appel d&#8217;une méthode statique inexistante de la classe</td>
</tr>
<tr class="row-odd"><td><strong>__isset()</strong></td>
<td>déclenchée si on applique <code class="docutils literal"><span class="pre">isset()</span></code> à une propriété de l&#8217;objet</td>
</tr>
<tr class="row-even"><td>__unset()</td>
<td>déclenchée si on applique <code class="docutils literal"><span class="pre">unset()</span></code> à une propriété de l&#8217;objet</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Méthodes magiques</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>__sleep()</td>
<td>exécutée si la fonction <code class="docutils literal"><span class="pre">serialize()</span></code> est appliquée à l&#8217;objet</td>
</tr>
<tr class="row-even"><td>__wakeup()</td>
<td>exécutée si la fonction <code class="docutils literal"><span class="pre">unserialize()</span></code> est appliquée à l&#8217;objet</td>
</tr>
<tr class="row-odd"><td><strong>__toString()</strong></td>
<td>appelée lorsque l&#8217;on essaie d&#8217;afficher directement l&#8217;objet : <code class="docutils literal"><span class="pre">echo</span> <span class="pre">$object;</span></code></td>
</tr>
<tr class="row-even"><td>__set_state()</td>
<td>méthode statique lancée lorsque l&#8217;on applique la fonction <code class="docutils literal"><span class="pre">var_export()</span></code> à l&#8217;objet</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Méthodes magiques</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>__clone()</td>
<td>appelé lorsque l&#8217;on essaie de cloner l&#8217;objet</td>
</tr>
<tr class="row-even"><td>__autoload()</td>
<td>cette fonction n&#8217;est pas une méthode, elle est déclarée dans le scope global et permet d&#8217;automatiser les <code class="docutils literal"><span class="pre">include</span></code>/<code class="docutils literal"><span class="pre">require</span></code> de classes PHP</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Variables réservés</h2>
<table border="1" class="first last docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>$this</strong></td>
<td>objet lui-même à l’intérieur d’une classe</td>
</tr>
</tbody>
</table>
</section>
<section>
<h2>Syntaxe de base</h2>
<div class="first last highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Voiture</span> <span class="p">{</span>

    <span class="k">const</span> <span class="no">CONSOMMATION</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1"># L/100km</span>
    <span class="k">const</span> <span class="no">CAPACITE_RESERVOIR</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span> <span class="c1">#L</span>

    <span class="k">public</span> <span class="nv">$kilometrage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$resteReservoir</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">roule</span><span class="p">(</span> <span class="nv">$distance</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">kilometrage</span> <span class="o">+=</span> <span class="nv">$distance</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">resteReservoir</span> <span class="o">-=</span> <span class="nx">self</span><span class="o">::</span><span class="na">CONSOMMATION</span> <span class="o">*</span> <span class="nv">$distance</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">peutEncoreRouler</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">resteReservoir</span> <span class="o">*</span> <span class="nx">self</span><span class="o">::</span><span class="na">CONSOMMATION</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$voiture1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Voiture</span><span class="p">();</span>
<span class="nv">$voiture1</span><span class="o">-&gt;</span><span class="na">roule</span><span class="p">(</span> <span class="mi">60</span> <span class="p">);</span>
<span class="nv">$voiture1</span><span class="o">-&gt;</span><span class="na">peutEncoreRouler</span><span class="p">(</span> <span class="p">);</span>
<span class="nb">var_dump</span><span class="p">(</span> <span class="nx">Voiture</span><span class="o">::</span><span class="na">CONSOMMATION</span> <span class="p">);</span>  <span class="c1">// Affiche int(4)</span>
</pre></div>
</div>
</section>
<section>
<h2>Héritage</h2>
<div class="first last highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Vehicule</span> <span class="p">{</span>

    <span class="k">public</span> <span class="nv">$kilometrage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">roule</span><span class="p">(</span> <span class="nv">$distance</span> <span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">kilometrage</span> <span class="o">+=</span> <span class="nv">$distance</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Voiture</span> <span class="k">extends</span> <span class="nx">Vehicule</span> <span class="p">{</span>

    <span class="k">const</span> <span class="no">CONSOMMATION</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="c1"># L/100km</span>
    <span class="k">const</span> <span class="no">CAPACITE_RESERVOIR</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span> <span class="c1">#L</span>

    <span class="k">protected</span> <span class="nv">$resteReservoir</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">roule</span><span class="p">(</span> <span class="nv">$distance</span> <span class="p">)</span> <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">roule</span><span class="p">(</span> <span class="nv">$distance</span> <span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">resteReservoir</span> <span class="o">-=</span> <span class="nx">self</span><span class="o">::</span><span class="na">CONSOMMATION</span> <span class="o">*</span> <span class="nv">$distance</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">peutEncoreRouler</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">resteReservoir</span> <span class="o">*</span> <span class="nx">self</span><span class="o">::</span><span class="na">CONSOMMATION</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section>
<h2>Exceptions</h2>
<div class="first last highlight-php"><div class="highlight"><pre><span class="k">try</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Exception</span><span class="p">(</span><span class="s1">&#39;Incident XY&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">();</span> <span class="c1">//affiche &quot;Incident XY&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section class="last">
<h2>Namespace</h2>
<div class="first last highlight-php"><div class="highlight"><pre><span class="k">namespace</span> <span class="nx">PHPUnit\Extensions\Database\DB\MetaData</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MySQL</span> <span class="k">extends</span> <span class="nx">InformationSchema</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section>
<section class="first">
<h1>Du navigateur vers Symfony</h1>
</section>
<section>
<h2>De votre navigateur</h2>
<img alt="_images/http.png" class="box first align-center" src="_images/http.png" />
<dl class="last docutils">
<dt>Requête HTTP</dt>
<dd><ul class="first last simple">
<li>la méthode utilisée (GET, POST, PUT, DELETE, etc.)</li>
<li>la page demandée</li>
<li>le type de requête (HTTP/1.1 par exemple)</li>
<li>des entêtes (headers)</li>
<li>le contenu de la requête</li>
</ul>
</dd>
</dl>
</section>
<section>
<h2>De votre navigateur</h2>
<img alt="_images/http.png" class="box first align-center" src="_images/http.png" />
<dl class="last docutils">
<dt>Réponse HTTP</dt>
<dd><ul class="first last simple">
<li>le type de requête (HTTP/1.1 par exemple)</li>
<li>le code de retour 200, 301/302, 401/403/404/410, 500</li>
<li>des entêtes (headers)</li>
<li>le contenu de la réponse</li>
</ul>
</dd>
</dl>
</section>
<section>
<h2>En passant par le serveur web</h2>
<img alt="_images/web_to_sf.png" class="box first last align-center" src="_images/web_to_sf.png" />
</section>
<section class="last">
<h2>Vers Symfony</h2>
<img alt="_images/symfony_request_flow.png" class="box first last align-center" src="_images/symfony_request_flow.png" />
</section>
</section>
<section>
<section class="first">
<h1>Installation</h1>
</section>
<section class="text-left">
<h2>Installation des paquets</h2>
<p class="first">Exécutez les commandes suivantes</p>
<div class="last highlight-console"><div class="highlight"><pre><span class="go">sudo apt-get install mysql-server mysql-client</span>
<span class="go">sudo apt-get install apache2</span>
<span class="go">sudo apt-get install curl git</span>
<span class="go">sudo apt-get install php5 php5-cli php5-intl php5-xsl \</span>
<span class="go">    php5-curl php5-mysql</span>
<span class="go">sudo apt-get install php5-xdebug</span>
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Configuration de PHP</h2>
<p class="first">Modifiez les lignes suivantes :</p>
<ul class="simple">
<li>dans <code class="file docutils literal"><span class="pre">/etc/php5/apache2/php.ini</span></code> :</li>
</ul>
<div class="highlight-ini"><div class="highlight"><pre><span class="c1">;date.timezone</span>
<span class="na">date.timezone</span>  <span class="o">=</span> <span class="s">Europe/Paris</span>
</pre></div>
</div>
<ul class="simple">
<li>dans <code class="file docutils literal"><span class="pre">/etc/php5/cli/php.ini</span></code> :</li>
</ul>
<div class="highlight-ini"><div class="highlight"><pre><span class="c1">;date.timezone</span>
<span class="na">date.timezone</span> <span class="o">=</span> <span class="s">Europe/Paris</span>
</pre></div>
</div>
<p>Ajoutez le ligne suivante à la fin du fichier <code class="file docutils literal"><span class="pre">/etc/php5/apache2/conf.d/20-xdebug.ini</span></code></p>
<div class="last highlight-ini"><div class="highlight"><pre><span class="na">xdebug.max_nesting_level</span> <span class="o">=</span> <span class="s">250</span>
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Correction des droits sur les fichiers</h2>
<p class="first">Exécutez les commandes suivantes</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">sudo usermod -a -G www-data $(whoami)</span>
<span class="go">sudo usermod -a -G $(whoami) www-data</span>
</pre></div>
</div>
<p>Ajoutez la ligne suivante à la fin du fichier <code class="file docutils literal"><span class="pre">~/.profile</span></code></p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">umask </span>002
</pre></div>
</div>
<p>Ajoutez la lignes suivante à la fin du fichier <code class="file docutils literal"><span class="pre">/etc/apache2/envvars</span></code></p>
<div class="last highlight-bash"><div class="highlight"><pre><span class="nb">umask </span>002
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Correction des droits sur les fichiers</h2>
<p class="first">Exécutez les commandes suivantes</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">sudo chown www-data:www-data -R /var/www</span>
<span class="go">sudo chmod g+w -R /var/www</span>
<span class="go">sudo service apache2 restart</span>
</pre></div>
</div>
<p class="last">Fermez votre session puis rouvrez-la</p>
</section>
<section class="text-left">
<h2>Installation de Symfony</h2>
<p class="first">Allez dans le répertoire <code class="file docutils literal"><span class="pre">/var/www</span></code></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">cd /var/www</span>
</pre></div>
</div>
<p>Téléchargez <strong class="program">Composer</strong></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">curl -sS https://getcomposer.org/installer | php</span>
</pre></div>
</div>
<p>Télécharger et installez <strong class="program">Symfony</strong> via <strong class="program">Composer</strong></p>
<div class="last highlight-console"><div class="highlight"><pre><span class="go">php composer.phar create-project \</span>
<span class="go">    symfony/framework-standard-edition ./symfony</span>
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Installation de Symfony</h2>
<p class="first">À la fin de l&#8217;installation, paramétrez votre installation de <strong class="program">Symfony</strong> en spécifiant les paramètres <code class="docutils literal"><span class="pre">database_user</span></code> et <code class="docutils literal"><span class="pre">database_password</span></code></p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Creating the &quot;app/config/parameters.yml&quot; file</span>
<span class="go">Some parameters are missing. Please provide them.</span>
<span class="go">database_host (127.0.0.1):</span>
<span class="go">database_port (null):</span>
<span class="go">database_name (symfony):</span>
<span class="go">database_user (root): symfony</span>
<span class="go">database_password (null): symfony_pass</span>
<span class="go">mailer_transport (smtp):</span>
<span class="go">mailer_host (127.0.0.1):</span>
<span class="go">mailer_user (null):</span>
<span class="go">mailer_password (null):</span>
<span class="go">secret (ThisTokenIsNotSoSecretChangeIt):</span>
</pre></div>
</div>
<p>Déplacez le fichier <code class="file docutils literal"><span class="pre">composer.phar</span></code> dans le répertoire <code class="file docutils literal"><span class="pre">symfony</span></code></p>
<div class="last highlight-console"><div class="highlight"><pre><span class="go">mv composer.phar symfony</span>
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Création de la base de données</h2>
<p class="first">Connectez-vous à MySQL</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">mysql -uroot -p</span>
</pre></div>
</div>
<p>Entrez les requêtes suivantes</p>
<div class="last highlight-mysql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">symfony</span><span class="p">;</span>
<span class="k">GRANT</span> <span class="k">ALL</span> <span class="k">ON</span> <span class="n">symfony</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="n">symfony</span><span class="o">@</span><span class="n">localhost</span> <span class="n">IDENTIFIED</span> <span class="k">BY</span> <span class="s1">&#39;symfony_pass&#39;</span><span class="p">;</span>
<span class="n">QUIT</span>
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Mise en place du VHost</h2>
<p class="first">Ajoutez la signe suivante à la fin du fichier <code class="file docutils literal"><span class="pre">/etc/hosts</span></code></p>
<div class="last highlight-bash"><div class="highlight"><pre>127.0.1.1  symfony.loc.epsi.fr
</pre></div>
</div>
</section>
<section class="text-left">
<h2>Mise en place du VHost</h2>
<p class="first">Créez le fichier <code class="file docutils literal"><span class="pre">/etc/apache2/sites-available/symfony.conf</span></code> et ajoutez-y les lignes suivantes</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
    <span class="nb">ServerName</span> symfony.loc.epsi.fr

    <span class="nb">DocumentRoot</span> <span class="sx">/var/www/symfony/web</span>
    <span class="nt">&lt;Directory</span> <span class="s">/var/www/symfony/web</span><span class="nt">&gt;</span>
        <span class="nb">AllowOverride</span> <span class="k">All</span>
        <span class="nb">Require</span> <span class="k">all</span> granted
    <span class="nt">&lt;/Directory&gt;</span>

    <span class="nb">ErrorLog</span> <span class="sx">/var/log/apache2/symfony.loc.epsi.fr_error.log</span>
    <span class="nb">CustomLog</span> <span class="sx">/var/log/apache2/symfony.loc.epsi.fr_access.log</span> combined
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>
</div>
<p>Activez le VHost et rechargez Apache</p>
<div class="last highlight-console"><div class="highlight"><pre><span class="go">sudo a2ensite symfony.conf</span>
<span class="go">sudo service apache2 reload</span>
</pre></div>
</div>
</section>
<section>
<h2>Vérification de votre configuration de PHP</h2>
<p class="first"><a class="reference external" href="http://symfony.loc.epsi.fr/config.php">http://symfony.loc.epsi.fr/config.php</a></p>
<img alt="_images/symfony_config_success.png" class="last" src="_images/symfony_config_success.png" />
</section>
<section class="last">
<h2>Vérification de votre configuration de PHP</h2>
<div class="first highlight-console"><div class="highlight"><pre><span class="go">cd /var/www/symfony</span>
<span class="go">php app/check.php</span>
</pre></div>
</div>
<img alt="_images/symfony_config_cli.png" class="last" src="_images/symfony_config_cli.png" />
</section>
</section>
<section>
<section class="first">
<h1>Architecture</h1>
</section>
<section class="text-left">
<h2>MVC</h2>
<dl class="first docutils">
<dt>Modèle (model)</dt>
<dd>Responsable des données et de tous les traitements faits sur les données</dd>
</dl>
<dl class="fragment docutils">
<dt>Vue (vue)</dt>
<dd>Affiche les données</dd>
</dl>
<dl class="fragment last docutils">
<dt>Contrôleur (controller)</dt>
<dd>Génère la réponse à la requête HTTP en utilisant les composants du framework</dd>
</dl>
</section>
<section>
<h2>Service-oriented - SOA</h2>
Déposer une fonctionnalité en un ensemble de fonctions basiques, appelées services</section>
<section class="last">
<h2>Fichiers</h2>
<div class="first last highlight-console"><div class="highlight"><pre><span class="gp">$</span> ls -A1 /var/www/symfony
<span class="go">app</span>
<span class="go">bin</span>
<span class="go">composer.json</span>
<span class="go">composer.lock</span>
<span class="go">composer.phar</span>
<span class="go">.git</span>
<span class="go">.gitignore</span>
<span class="go">LICENSE</span>
<span class="go">nbproject</span>
<span class="go">README.md</span>
<span class="go">src</span>
<span class="go">UPGRADE-2.2.md</span>
<span class="go">UPGRADE-2.3.md</span>
<span class="go">UPGRADE-2.4.md</span>
<span class="go">UPGRADE.md</span>
<span class="go">vendor</span>
<span class="go">web</span>
</pre></div>
</div>
</section>
</section>
<section>
<section class="first last">
<h2>Blog</h2>
<ul class="first last simple">
<li>Nous aurons des posts écris par des auteurs, auxquels nous attacherons des tags.</li>
<li>Les tags pourront être attachés à plusieurs posts.</li>
<li>Les auteurs peuvent écrire plusieurs posts.</li>
<li>Nous pourrons lire, écrire, éditer et rechercher des posts.</li>
<li>Nous pourrons créer, modifier et supprimer des tags.</li>
<li>Nous pourrons également commenter les posts.</li>
<li>Nous n’aurons pas de système de gestion des utilisateurs : nous devrons choisir l’utilisateur lorsque nous rédigerons un post ou un commentaire.</li>
</ul>
</section>
</section>
<section>
<section class="first">
<h1>Les bundles</h1>
</section>
<section class="text-left">
<h2>Nommage du namespace des bundles</h2>
<p class="first"><code class="docutils literal"><span class="pre">Vendor\Bundle\Categories\BundleNameBundle</span></code></p>
<dl class="last docutils">
<dt>Vendor</dt>
<dd>Auteur du bundle</dd>
<dt>Bundle</dt>
<dd>Le namespace Bundle (optionnel mais conseillé)</dd>
<dt>Categories</dt>
<dd>Un ou plusieurs namespaces de catégorisation (optionnel)</dd>
<dt>BundleNameBundle</dt>
<dd>Le nom du bundle en lui même qui doit décrire la fonction implémentée par le bundle en un ou deux mots suivit de Bundle</dd>
</dl>
</section>
<section class="text-left">
<h2>Nommage du namespace des bundles</h2>
<p class="first">Exemple</p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">Epsi\Bundle\BlogBundle</span></code></li>
<li><code class="docutils literal"><span class="pre">Epsi\Bundle\Social\BlogBundle</span></code></li>
</ul>
</section>
<section class="text-left">
<h2>Création d'un bundle</h2>
<p class="first">Exécutez la commande suivante</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">php app/console generate:bundle</span>
</pre></div>
</div>
<dl class="last docutils">
<dt>Bundle namespace</dt>
<dd>Epsi/Bundle/BlogBundle</dd>
<dt>Bundle name</dt>
<dd>Gardez la valeur par défaut EpsiBlogBundle</dd>
<dt>Target directory</dt>
<dd>Gardez la valeur par défaut /var/www/symfony/src</dd>
<dt>Configuration format (yml, xml, php, or annotation)</dt>
<dd>Choisissez annotation</dd>
</dl>
</section>
<section class="text-left">
<h2>Création d'un bundle</h2>
<dl class="first last docutils">
<dt>Do you want to generate the whole directory structure [no]</dt>
<dd>Répondez yes</dd>
<dt>Do you confirm generation [yes]</dt>
<dd>Répondez yes</dd>
<dt>Confirm automatic update of your Kernel [yes]</dt>
<dd>Répondez yes</dd>
<dt>Confirm automatic update of the Routing [yes]</dt>
<dd>Répondez yes</dd>
</dl>
</section>
<section class="text-left last">
<h2>Structure d'un bundle</h2>
<div class="first last highlight-console"><div class="highlight"><pre><span class="go">src/Epsi/Bundle/BlogBundle/</span>
<span class="go">├── Controller</span>
<span class="go">│   └── DefaultController.php</span>
<span class="go">├── DependencyInjection</span>
<span class="go">│   ├── Configuration.php</span>
<span class="go">│   └── EpsiBlogExtension.php</span>
<span class="go">├── Entity</span>
<span class="go">│   ├── User.php</span>
<span class="go">│   └── UserRepository.php</span>
<span class="go">├── EpsiBlogBundle.php</span>
<span class="go">├── Resources</span>
<span class="go">│   ├── config</span>
<span class="go">│   │   └── services.xml</span>
<span class="go">│   ├── doc</span>
<span class="go">│   │   └── index.rst</span>
<span class="go">│   ├── public</span>
<span class="go">│   │   ├── css</span>
<span class="go">│   │   ├── images</span>
<span class="go">│   │   └── js</span>
<span class="go">│   ├── translations</span>
<span class="go">│   │   └── messages.fr.xlf</span>
<span class="go">│   └── views</span>
<span class="go">│       └── Default</span>
<span class="go">│           └── index.html.twig</span>
<span class="go">└── Tests</span>
<span class="go">    └── Controller</span>
<span class="go">        └── DefaultControllerTest.php</span>
</pre></div>
</div>
</section>
</section>
<section>
<section class="first">
<h1>Le web-profiler</h1>
</section>
<section class="text-left">
<h2>Activation</h2>
<p class="first">Dans votre bundle, modifiez le fichier <code class="docutils literal"><span class="pre">Resources/views/Default/index.html.twig</span></code> comme suit</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;::base.html.twig&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
    Hello <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>!
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p class="last">Allez sur la page <a class="reference external" href="http://symfony.loc.epsi.fr/app_dev.php/hello/World">http://symfony.loc.epsi.fr/app_dev.php/hello/World</a></p>
</section>
<section>
<img alt="_images/web_toolbar_description.png" class="box first last align-center" src="_images/web_toolbar_description.png" />
</section>
<section class="last">
<img alt="_images/web_profiler_full.png" class="box first last align-center" src="_images/web_profiler_full.png" />
</section>
</section>
<section>
<section class="first">
<h1>Le routeur</h1>
</section>
<section class="text-left">
<h2>Definition</h2>
<p class="first">Le router fait la correspondance entre les URLs et les les contrôleurs</p>
<table border="1" class="last docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Nom</th>
<th class="head">Chemin</th>
<th class="head">Contrôleur</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>epsi_blog_default_index</td>
<td>/hello/{name}</td>
<td>EpsiBlogBundle:Default:index</td>
</tr>
<tr class="row-odd"><td>epsi_blog_post_index</td>
<td>/post</td>
<td>EpsiBlogBundle:Post:index</td>
</tr>
<tr class="row-even"><td>epsi_blog_post_new</td>
<td>/post/new</td>
<td>EpsiBlogBundle:Post:new</td>
</tr>
<tr class="row-odd"><td>epsi_blog_post_show</td>
<td>/post/{id}</td>
<td>EpsiBlogBundle:Post:show</td>
</tr>
</tbody>
</table>
</section>
<section class="last">
<h2>Suite du cours</h2>
<a class="reference external" href="http://mveyrenc.github.io/symfony/_build/html/routing.html">http://mveyrenc.github.io/symfony/_build/html/routing.html</a></section>
</section>


      </div>
    </div>
    
<script src="_static/js/jquery.min.js"></script>
<script src="_static/lib/js/head.min.js"></script>
<script src="_static/js/reveal.js"></script>
    <script>

      // change DOM for reveal.js
      $("div.section h1").remove();
      var content = $("div.section").html();
      $("div.section").remove();
      $("div.slides").html(content);

      Reveal.initialize({
        width: 960,
        height: 700,

        margin: 0.1,

        minScale: 0.2,
        maxScale: 1.0,

        controls: true,
        progress: true,
        history: true,
        center: true,

        keyboard : true,
        overview: true,
        touch: true,
        loop: false,
        rtl: false,
        fragments: true,

        autoSlide: 0,
        mouseWheel: false,
        rollingLinks: false,
        previewLinks: false,

        transitionSpeed: "default",
        backgroundTransition: "default",

        slideNumber: true,
        embedded: false,
        autoSlideStoppable: true,
        hideAddressBar: true,

        parallaxBackgroundImage: "",
        parallaxBackgroundSize: "",

        focusBodyOnPageVisiblityChange: true,

        viewDistance: 3,

        transition: Reveal.getQueryHash().transition || "default",

        

        dependencies: [
           { src: '_static/lib/js/classList.js', condition: function() { return !document.body.classList; } },
           { src: '_static/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
           { src: '_static/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
           { src: '_static/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
           { src: '_static/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
           { src: '_static/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });
    </script>
    
  </body>
</html>